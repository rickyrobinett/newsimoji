class e extends Error{key;constructor(e){super(e),this.message=e}}class t extends e{constructor(e){super(e)}}class r{static isParameter=!0;isParameter=!0;type="string";params;generated;constructor(e){this.params=e||{},this.generated=!0,void 0===this.params.required&&(this.params.required=!0)}getValue(){const e={type:this.type,description:this.params.description,example:this.params.example,default:this.params.default};return this.params.deprecated&&(e.deprecated=this.params.deprecated),e}validate(e){return e}}class a extends r{isArr=!0;innerType;constructor(e,t){super(t),this.innerType=e}validate(e){return e=super.validate(e),!1!==this.params.required||null!==e&&""!==e?e=Array.isArray(e)?e.map((e=>this.innerType.validate(e))):[this.innerType.validate(e)]:null}getValue(){return{type:"array",items:this.innerType.getValue(),description:this.params.description,example:this.params.example,default:this.params.default}}}class s extends r{isObj=!0;fields;constructor(e,t){super(t),this.fields=e}validate(e){e=super.validate(e);for(const[r,a]of Object.entries(this.fields))try{if(void 0===e[r]||null===e[r]){if(a.params.required)throw new t("is required")}else e[r]=a.validate(e[r])}catch(e){throw e.key=(e.key||"")+`.${r}`,e}return e}getValue(){const e={type:"object",properties:{}},t=[];for(const[r,a]of Object.entries(this.fields))!0===a.params?.required&&t.push(r),a.getValue?e.properties[r]=a.getValue():e.properties[r]=a;return t.length>0&&(e.required=t),this.params.xml&&(e.xml=this.params.xml),e}}class n extends r{type="number";validate(e){if(e=super.validate(e),e=Number.parseFloat(e),isNaN(e))throw new t("is not a valid number");return e}}class i extends n{type="integer";validate(e){if(e=super.validate(e),e=Number.parseInt(e),isNaN(e))throw new t("is not a valid integer");return e}}class d extends r{type="string";constructor(e){super(e)}validate(e){if("string"!=typeof(e=super.validate(e))&&(e=e.toString()),this.params.format)if("date-time"===this.params.format){if(e=new Date(e),isNaN(e.getDay()))throw new t("is not a valid date time")}else if("date"===this.params.format){if(!e.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/))throw new t("is not a valid date");if(e=new Date(e),isNaN(e.getDay()))throw new t("is not a valid date")}return e}getValue(){return{...super.getValue(),format:this.params.format}}}class o extends d{type="string";constructor(e){super({example:"2022-09-15T00:00:00Z",...e,format:"date-time"})}}class p extends d{type="string";constructor(e){super(e)}validate(e){if(!(e=super.validate(e)).match(this.params.pattern)){if(this.params.patternError)throw new t(`is not a valid ${this.params.patternError}`);throw new t(`does not match the pattern ${this.params.format}`)}return e}getValue(){return{...super.getValue(),pattern:this.params.pattern}}}class u extends p{type="string";constructor(e){super({pattern:"^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$",patternError:"email",...e,format:"email"})}}class l extends p{type="string";constructor(e){super({pattern:"^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",patternError:"uuid",...e,format:"uuid"})}}class c extends p{type="string";constructor(e){super({pattern:"^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$",patternError:"hostname",...e,format:"hostname"})}}class m extends p{type="string";constructor(e){super({pattern:"^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$",patternError:"ipv4",...e,format:"ipv4"})}}class f extends p{type="string";constructor(e){super({pattern:"^(?:(?:[a-fA-F\\d]{1,4}:){7}(?:[a-fA-F\\d]{1,4}|:)|(?:[a-fA-F\\d]{1,4}:){6}(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|:[a-fA-F\\d]{1,4}|:)|(?:[a-fA-F\\d]{1,4}:){5}(?::(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?::[a-fA-F\\d]{1,4}){1,2}|:)|(?:[a-fA-F\\d]{1,4}:){4}(?:(?::[a-fA-F\\d]{1,4}){0,1}:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?::[a-fA-F\\d]{1,4}){1,3}|:)|(?:[a-fA-F\\d]{1,4}:){3}(?:(?::[a-fA-F\\d]{1,4}){0,2}:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?::[a-fA-F\\d]{1,4}){1,4}|:)|(?:[a-fA-F\\d]{1,4}:){2}(?:(?::[a-fA-F\\d]{1,4}){0,3}:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?::[a-fA-F\\d]{1,4}){1,5}|:)|(?:[a-fA-F\\d]{1,4}:){1}(?:(?::[a-fA-F\\d]{1,4}){0,4}:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?::[a-fA-F\\d]{1,4}){1,6}|:)|(?::(?:(?::[a-fA-F\\d]{1,4}){0,5}:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?::[a-fA-F\\d]{1,4}){1,7}|:)))(?:%[0-9a-zA-Z]{1,})?$",patternError:"ipv6",...e,format:"ipv6"})}}class h extends d{type="string";constructor(e){super({example:"2022-09-15",...e,format:"date"})}}class y extends d{type="boolean";validValues=["true","false"];validate(e){if(e=(e=super.validate(e)).toLowerCase(),!this.validValues.includes(e))throw new t("is not a valid boolean, allowed values are true or false");return e="true"===e}}class w extends d{isEnum=!0;values;keys;constructor(e){super(e);let{values:t}=e;Array.isArray(t)&&(t=Object.fromEntries(t.map((e=>[e,e])))),this.keys=Object.keys(t),this.values=t}validate(e){if(e=super.validate(e),!1!==this.params.enumCaseSensitive)e=this.params.values[e];else{const t=this.keys.find((t=>t.toLowerCase()===e.toLowerCase()));e=this.params.values[t]}if(void 0===e){if(!0===this.params.required)throw new t("is not one of available options");return null}return e}getValue(){return{...super.getValue(),enum:this.keys}}}class v{location;rawType;type;params;constructor(e,t,r){this.location=e,this.rawType=t,void 0===r.required&&(r.required=!0),this.params=r,this.type=this.getType(t,r)}getType(e,t){if(!0===e.generated)return e;if(!0===e.isParameter)return new e({...t});if(e===String)return new d({...t});if("string"==typeof e)return new d({example:e});if(e===Number)return new n({...t});if("number"==typeof e)return new n({example:e});if(e===Boolean)return new y({...t});if("boolean"==typeof e)return new y({example:e});if(e===Date)return new o;if(Array.isArray(e)){if(0===e.length)throw new Error("Arr must have a type");return new a(this.getType(e[0],t),{...t})}if("object"==typeof e){const r={};for(const[t,a]of Object.entries(e))r[t]=this.getType(a,{});return new s(r,t)}throw new Error(`${e} not implemented`)}getValue(){const e=E(this.type.getValue());return{description:this.params.description,required:this.params.required,schema:e,name:this.params.name,in:this.location}}validate(e){if(null==e){if(void 0===this.params.default||null===this.params.default){if(this.params.required)throw new t("is required");return null}e=this.params.default}return e=this.type.validate(e)}}class g extends v{paramsBody;constructor(e,t){super(null,e,{}),this.paramsBody=t}getValue(){const e=E(this.type.getValue()),t={description:this.paramsBody?.description,content:{}};return t.content[this.paramsBody?.contentType||"application/json"]={schema:e},t}}class A extends v{constructor(e,t){super(null,e,t)}getValue(){const e=super.getValue(),t=this.params?.contentType?this.params?.contentType:"application/json",r={description:this.params.description||"Successful Response",content:{}};return r.content[t]={schema:e.schema},r}}function x(e,t={}){return new v("query",e,t)}function F(e,t={}){return new v("path",e,t)}function b(e,t={}){return new v("header",e,t)}function V(e,t={}){return new v("cookie",e,t)}function q(e,t,r,a){if("query"===a)return t[r];if("path"===a)return e.params[r];if("header"===a)return e.headers.get(r);if("cookie"===a)throw new Error("Cookie parameters not implemented yet")}function T(e){const t=decodeURIComponent(e.url).split("?");if(1===t.length)return{};const r=t.slice(1).join("?"),a={};for(const e of r.split("&")){const t=e.split("="),r=t[0],s=t[1];void 0===a[r]?a[r]=s:Array.isArray(a[r])?a[r].push(s):a[r]=[a[r],s]}return a}function j(e){return e.params.required=!0,e}function E(e){for(const[t,r]of Object.entries(e))"object"!=typeof r||Array.isArray(r)||(e[t]=E(r)),void 0===r&&delete e[t];return e}function k(e){const t=[],r=Array.isArray(e);for(const[a,s]of Object.entries(e||{})){if(r&&!s.params.name)throw new Error("Parameter must have a defined name when using as Array");const e=s.params.name?s.params.name:a;t.push({...s.getValue(),name:e})}return t}export{a as Arr,r as BaseParameter,g as Body,y as Bool,V as Cookie,h as DateOnly,o as DateTime,u as Email,w as Enumeration,b as Header,c as Hostname,i as Int,m as Ipv4,f as Ipv6,n as Num,s as Obj,v as Parameter,F as Path,x as Query,p as Regex,j as Required,A as Resp,d as Str,l as Uuid,q as extractParameter,T as extractQueryParameters,k as getFormatedParameters,E as removeUndefinedFields};
